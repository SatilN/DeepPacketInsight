# src/malware_triage.py
import hashlib
import vt

class MalwareAnalyzer:
    def __init__(self, api_key):
        self.client = vt.Client(api_key)
    
    def extract_files(self, pcap_path):
        """Carve executables from PCAP"""
        with open(pcap_path, "rb") as f:
            return carve_pe_files(f.read())  # Custom PE header detection
    
    def analyze_file(self, file_data):
        """Submit files to VirusTotal"""
        file_hash = hashlib.sha256(file_data).hexdigest()
        try:
            report = self.client.get_object(f"/files/{file_hash}")
            return report.last_analysis_stats
        except vt.APIError:
            return {"malicious": 0, "undetected": 0}